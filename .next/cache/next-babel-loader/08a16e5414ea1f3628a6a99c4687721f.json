{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/ajay/Desktop/webdev/community-app/frontend/pages/_app.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport App from \"next/app\";\nimport Head from \"next/head\";\nimport Cookie from \"js-cookie\";\nimport fetch from \"isomorphic-fetch\";\nimport Layout from \"../components/Layout\";\nimport AppContext from \"../context/AppContext\";\nimport Footer from \"../components/Footer\";\nimport '../styles/global.css';\nimport '../node_modules/font-awesome/css/font-awesome.css'; // import withData from \"../lib/apollo\";\n\nvar MyApp = /*#__PURE__*/function (_App) {\n  _inherits(MyApp, _App);\n\n  var _super = _createSuper(MyApp);\n\n  function MyApp() {\n    var _this;\n\n    _classCallCheck(this, MyApp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      user: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setUser\", function (user) {\n      _this.setState({\n        user: user\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(MyApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // grab token value from cookie\n      var token = Cookie.get(\"token\");\n\n      if (token) {\n        // authenticate the token on the server and place set user object\n        fetch(\"\".concat(process.env.NEXT_PUBLIC_API_URL, \"users/me\"), {\n          headers: {\n            Authorization: \"Bearer \".concat(token)\n          }\n        }).then( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(res) {\n            var user;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    if (res.ok) {\n                      _context.next = 4;\n                      break;\n                    }\n\n                    Cookie.remove(\"token\");\n\n                    _this2.setState({\n                      user: null\n                    });\n\n                    return _context.abrupt(\"return\", null);\n\n                  case 4:\n                    _context.next = 6;\n                    return res.json();\n\n                  case 6:\n                    user = _context.sent;\n\n                    _this2.setUser(user);\n\n                  case 8:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee);\n          }));\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps;\n      return __jsx(AppContext.Provider, {\n        value: {\n          user: this.state.user,\n          isAuthenticated: !!this.state.user,\n          setUser: this.setUser\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 7\n        }\n      }, __jsx(Head, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 9\n        }\n      }, __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\",\n        integrity: \"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\",\n        crossOrigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }\n      }), __jsx(\"link\", {\n        href: \"https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic\",\n        rel: \"stylesheet\",\n        type: \"text/css\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }\n      }), __jsx(\"link\", {\n        href: \"https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800\",\n        rel: \"stylesheet\",\n        type: \"text/css\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }\n      })), __jsx(Layout, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 9\n        }\n      }, __jsx(Component, _extends({}, pageProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }\n      }))), __jsx(\"hr\", {\n        className: \"my-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 9\n        }\n      }), __jsx(Footer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return MyApp;\n}(App);\n\nexport default MyApp;","map":{"version":3,"sources":["/home/ajay/Desktop/webdev/community-app/frontend/pages/_app.js"],"names":["React","App","Head","Cookie","fetch","Layout","AppContext","Footer","MyApp","user","setState","token","get","process","env","NEXT_PUBLIC_API_URL","headers","Authorization","then","res","ok","remove","json","setUser","props","Component","pageProps","state","isAuthenticated"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport App from \"next/app\";\nimport Head from \"next/head\";\nimport Cookie from \"js-cookie\";\nimport fetch from \"isomorphic-fetch\";\nimport Layout from \"../components/Layout\";\nimport AppContext from \"../context/AppContext\";\nimport Footer from \"../components/Footer\";\nimport '../styles/global.css';\nimport '../node_modules/font-awesome/css/font-awesome.css'\n// import withData from \"../lib/apollo\";\n\nclass MyApp extends App {\n  state = {\n    user: null,\n  };\n\n  componentDidMount() {\n    // grab token value from cookie\n    const token = Cookie.get(\"token\");\n\n    if (token) {\n      // authenticate the token on the server and place set user object\n      fetch(`${process.env.NEXT_PUBLIC_API_URL}users/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      }).then(async (res) => {\n        // if res comes back not valid, token is not valid\n        // delete the token and log the user out on client\n        if (!res.ok) {\n          Cookie.remove(\"token\");\n          this.setState({ user: null });\n          return null;\n        }\n        const user = await res.json();\n        this.setUser(user);\n      });\n    }\n  }\n\n  setUser = (user) => {\n    this.setState({ user });\n  };\n\n  render() {\n    const { Component, pageProps } = this.props;\n\n    return (\n      <AppContext.Provider\n        value={{\n          user: this.state.user,\n          isAuthenticated: !!this.state.user,\n          setUser: this.setUser,\n        }}\n      >\n        <Head>\n          <link\n            rel=\"stylesheet\"\n            href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\"\n            integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\"\n            crossOrigin=\"anonymous\"\n          />\n          <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css' />\n          <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' />\n          \n        </Head>\n\n        <Layout>\n          <Component {...pageProps} />\n        </Layout>\n        <hr className=\"my-3\"/>\n        <Footer></Footer>\n      </AppContext.Provider>\n    );\n  }\n}\n\nexport default MyApp;\n"]},"metadata":{},"sourceType":"module"}